<!-- <!DOCTYPE html>
<html>
  <head>
    <title>Steps Example</title>
    <style>
      body {
        background-color: #F7F7F7;
        font-family: Arial, sans-serif;
      }

      label {
        display: block;
        font-weight: bold;
        margin-bottom: 10px;
      }

      input[type="text"] {
        border: none;
        border-radius: 5px;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
        font-size: 18px;
        padding: 10px;
        width: 300px;
      }

      input[type="text"]:focus {
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
        outline: none;
      }

      ul {
        list-style: none;
        margin: 0;
        padding: 0;
      }

      li {
        background-color: #FFFFFF;
        border-radius: 5px;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
        margin-bottom: 10px;
        padding: 10px;
      }
    </style>
  </head>
  <body>
    <div style="margin: 20px;">
      <label for="step-input">Enter a Step:</label>
      <input type="text" id="step-input">

      <ul id="step-list"></ul>
    </div>

    <script>
      // Initialize an empty array to store the steps
      let stepsArray = [];

      // Get the input element from the HTML page
      let input = document.querySelector("#step-input");

      // Get the step list element from the HTML page
      let stepList = document.querySelector("#step-list");

      // Add an event listener to the input element
      input.addEventListener("keyup", function(event) {
        // Check if the user pressed the enter key
        if (event.key === "Enter") {
          // Add the new step to the array
          stepsArray.push(event.target.value);
          // Clear the input field
          event.target.value = "";
          // Add the new step to the list
          let newStep = document.createElement("li");
          newStep.textContent = stepsArray[stepsArray.length - 1];
          stepList.appendChild(newStep);
        }
      });
    </script>
  </body>
</html> -->
<!-- 
<!DOCTYPE html>
<html>
  <head>
    <title>Create Document</title>
    <style>
      body {
        background-color: #F7F7F7;
        font-family: Arial, sans-serif;
      }

      .page-title {
        font-size: 32px;
        font-weight: bold;
        margin-bottom: 20px;
        text-align: center;
      }

      label {
        display: block;
        font-weight: bold;
        margin-bottom: 10px;
      }

      input[type="text"] {
        border: none;
        border-radius: 5px;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
        font-size: 18px;
        padding: 10px;
        width: 300px;
      }

      input[type="text"]:focus {
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
        outline: none;
      }

      .enter-section {
        display: flex;
        justify-content: center;
        align-items: center;
        height: calc(100vh - 200px);
      }

      ul {
        list-style: none;
        margin: 0;
        padding: 0;
      }

      li {
        background-color: #FFFFFF;
        border-radius: 5px;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
        margin-bottom: 10px;
        padding: 10px;
      }
    </style>
  </head>
  <body>
    <div style="margin: 20px;">
      <div class="page-title">Create Document</div>
      <div class="enter-section">
        <label for="enter-input">Enter:</label>
        <input type="text" id="enter-input">
      </div>

      <ul id="enter-list"></ul>
    </div>

    <script>
      // Initialize an empty array to store the inputs
      let enterArray = [];

      // Get the input element from the HTML page
      let input = document.querySelector("#enter-input");

      // Get the enter list element from the HTML page
      let enterList = document.querySelector("#enter-list");

      // Add an event listener to the input element
      input.addEventListener("keyup", function(event) {
        // Check if the user pressed the enter key
        if (event.key === "Enter") {
          // Add the new input to the array
          enterArray.push(event.target.value);
          // Clear the input field
          event.target.value = "";
          // Add the new input to the list
          let newInput = document.createElement("li");
          newInput.textContent = enterArray[enterArray.length - 1];
          enterList.appendChild(newInput);
        }
      });
    </script>
  </body>
</html> -->

<!-- 
<!DOCTYPE html>
<html>
<head>
	<title>Create Document</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			margin: 0;
			padding: 0;
			display: flex;
			flex-direction: column;
			min-height: 100vh;
		}

		header {
			background-color: #333;
			color: #fff;
			padding: 1rem;
			text-align: center;
		}

		main {
			flex-grow: 1;
			display: flex;
			flex-direction: row;
		}

		form {
			flex-grow: 1;
			padding: 1rem;
		}

		label {
			display: block;
			margin-bottom: 0.5rem;
		}

		input {
			display: block;
			margin-bottom: 1rem;
			padding: 0.5rem;
			border: 1px solid #ccc;
			border-radius: 4px;
			width: 100%;
		}

		textarea {
			display: block;
			margin-bottom: 1rem;
			padding: 0.5rem;
			border: 1px solid #ccc;
			border-radius: 4px;
			width: 100%;
			height: 300px;
		}

		section {
			flex-grow: 1;
			padding: 1rem;
			border-left: 1px solid #ccc;
		}

		section h2 {
			margin-top: 0;
		}

		button {
			background-color: #333;
			color: #fff;
			padding: 0.5rem 1rem;
			border: none;
			border-radius: 4px;
			cursor: pointer;
		}

		button:hover {
			background-color: #666;
		}
	</style>
</head>
<body>
	<header>
		<h1>Create Document</h1>
	</header>
	<main>
		<form>
			<label for="title">Title and Type:</label>
			<input type="text" id="title" name="title" required>

			<label for="sections">Enter sections:</label>
			<textarea id="sections" name="sections" required></textarea>

			<button type="submit">Submit</button>
		</form>
		<section id="preview">
			<h2>Preview</h2>
			<h3 id="title-preview"></h3>
			<div id="sections-preview"></div>
		</section>
	</main>
	<script>
		const titleInput = document.getElementById('title');
		const sectionsInput = document.getElementById('sections');
		const titlePreview = document.getElementById('title-preview');
		const sectionsPreview = document.getElementById('sections-preview');

		titleInput.addEventListener('input', () => {
			titlePreview.textContent = titleInput.value;
		});

		sectionsInput.addEventListener('input', () => {
			sectionsPreview.innerHTML = sectionsInput.value;
		});

		document.querySelector('form').addEventListener('submit', event => {
			event.preventDefault();
			alert('Document submitted!');
		});
	</script>
</body>
</html>
 -->

<!-- 
 <!DOCTYPE html>
<html>
<head>
	<title>Document Creator</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			margin: 0;
			padding: 0;
		}
		.container {
			display: flex;
			flex-wrap: wrap;
		}
		.input-container {
			width: 50%;
			height: 100vh;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
		}
		.preview-container {
			width: 50%;
			height: 100vh;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
		}
		h1, h2, label, input, textarea, button {
			margin: 10px;
			font-size: 1.2rem;
		}
		input[type="text"], textarea {
			width: 80%;
			padding: 10px;
			border: 1px solid #ccc;
			border-radius: 5px;
		}
		button {
			padding: 10px;
			background-color: #4CAF50;
			color: white;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			transition: background-color 0.3s ease;
		}
		button:hover {
			background-color: #3e8e41;
		}
	</style>
</head>
<body>
	<div class="container">
		<div class="input-container">
			<h1>Document Creator</h1>
			<label for="title">Title:</label>
			<input type="text" id="title" placeholder="Enter document title">
			<label for="type">Type:</label>
			<input type="text" id="type" placeholder="Enter document type">
			<label for="section">Section:</label>
			<textarea id="section" placeholder="Enter section details"></textarea>
			<button id="addSection">Add Section</button>
		</div>
		<div class="preview-container">
			<h1>Preview</h1>
			<h2 id="previewTitle"></h2>
			<h2 id="previewType"></h2>
			<div id="previewSections"></div>
			<button id="submit">Submit</button>
		</div>
	</div>

	<script>
		const titleInput = document.getElementById("title");
		const typeInput = document.getElementById("type");
		const sectionInput = document.getElementById("section");
		const addSectionButton = document.getElementById("addSection");
		const previewTitle = document.getElementById("previewTitle");
		const previewType = document.getElementById("previewType");
		const previewSections = document.getElementById("previewSections");
		const submitButton = document.getElementById("submit");

		let sections = [];

		addSectionButton.addEventListener("click", () => {
			const section = sectionInput.value.trim();
			if (section !== "") {
				sections.push(section);
				renderSections();
				sectionInput.value = "";
			}
		});

		function renderSections() {
            previewSections.innerHTML = "";
            sections.forEach((section, index) => {
                const sectionDiv = document.createElement("div");
                const sectionHeader = document.createElement("h2");
                const sectionText = document.createElement("p");
                const editButton = document.createElement("button");
                const deleteButton = document.createElement("button");

                sectionHeader.innerText = section.title;
                sectionText.innerText = section.text;
                editButton.innerText = "Edit";
                deleteButton.innerText = "Delete";

                editButton.addEventListener("click", () => {
                editSection(index);
                });

                deleteButton.addEventListener("click", () => {
                deleteSection(index);
                });

                sectionDiv.appendChild(sectionHeader);
                sectionDiv.appendChild(sectionText);
                sectionDiv.appendChild(editButton);
                sectionDiv.appendChild(deleteButton);

                previewSections.appendChild(sectionDiv);
            });
        }

        function editSection(index) {
  const section = sections[index];
  const title = prompt("Enter section title:", section.title);
  const text = prompt("Enter section text:", section.text);
  if (title && text) {
    sections[index] = { title, text };
    renderSections();
  }
}

function deleteSection(index) {
  sections.splice(index, 1);
  renderSections();
}

document.addEventListener("DOMContentLoaded", () => {
  addSectionButton.addEventListener("click", () => {
    const title = sectionTitleInput.value;
    const text = sectionTextInput.value;
    if (title && text) {
      sections.push({ title, text });
      sectionTitleInput.value = "";
      sectionTextInput.value = "";
      renderSections();
    }
  });
});

</script>
</body>
</html>
 -->

<!-- 
 <!DOCTYPE html>
<html>
  <head>
    <title>Create Document</title>
    <style>
        /* Center content horizontally and vertically */
        html, body {
            height: 100%;
        }
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
    
        /* Set up the two-column layout */
        .container {
            display: flex;
            flex-direction: row;
            max-width: 800px;
            width: 100%;
        }
        .form-container {
            flex-basis: 50%;
            padding: 20px;
            background-color: #eee;
        }
        .preview-container {
            flex-basis: 50%;
            padding: 20px;
            background-color: #ddd;
        }
    
        /* Style the form inputs and buttons */
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
        }
        input[type="text"],
        select {
            display: block;
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        textarea {
            display: block;
            width: 100%;
            height: 100px;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        button[type="submit"] {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #333;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button[type="submit"]:hover {
            background-color: #555;
        }
    
        /* Style the preview sections */
        h2 {
            font-size: 24px;
            margin-bottom: 10px;
        }
        p {
            margin-bottom: 20px;
        }
        button {
            margin-right: 10px;
            background-color: #333;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #555;
            color: #fff;
        }
        .edit-button {
            background-color: #ffcc00;
            color: #333;
        }
        .edit-button:hover {
            background-color: #ffc107;
            color: #333;
        }
        .delete-button {
            background-color: #dc3545;
            color: #fff;
        }
        .delete-button:hover {
            background-color: #c82333;
            color: #fff;
        }
    </style>
    
  </head>
  <body>
    <div>
      <h1>Create a New Document</h1>
      <form>
        <label for="title">Title:</label>
        <input type="text" id="title" name="title">

        <label for="documentType">Document Type:</label>
        <select id="documentType" name="documentType">
          <option value="article">Article</option>
          <option value="report">Report</option>
          <option value="proposal">Proposal</option>
          <option value="other">Other</option>
        </select>

        <div>
          <label for="sectionTitle">Section Title:</label>
          <input type="text" id="sectionTitle" name="sectionTitle">

          <label for="sectionContent">Section Content:</label>
          <textarea id="sectionContent" name="sectionContent"></textarea>

          <button type="button" id="addSectionButton">Add Section</button>
        </div>
      </form>
    </div>

    <div>
      <h2>Preview</h2>
      <div id="previewSections"></div>
      <button type="button" id="submitButton">Submit</button>
    </div>
  </body>
</html>
 -->

 <!-- <!DOCTYPE html>
<html>
<head>
	<title>Document Creator</title>
   
    
</head>
<body>
	<div class="container">
		<div class="input-container">
			<h1>Word Document Content Creator</h1>
			<label for="title">Title:</label>
			<input type="text" id="title" placeholder="Enter document title">
			<label for="type">Type:</label>
			<input type="text" id="type" placeholder="Enter document type">
			<label for="section">Section:</label>
			<textarea id="section" placeholder="Enter section details"></textarea>
			<button id="addSection">Add Section</button>
		</div>
		<div class="preview-container">
			<h1>Preview</h1>
			<h2 id="previewTitle"></h2>
			<h2 id="previewType"></h2>
			<div id="previewSections"></div>
			<button id="submit">Generate</button>
		</div>
	</div>
   
      
</body>
</html> -->


<!DOCTYPE html>
<html>
<head>
	<title>Content Generator for Word Document</title>
    <style>
 
        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: flex-start;
        }

        /* .sidebar{
            flex-basis: 20%;
            padding: 1rem;
            box-sizing: border-box;            
        }
     */
        .input-container {
            flex-basis: 50%;
            padding: 1rem;
            box-sizing: border-box;
        }
    
        .input-container h1 {
            margin-bottom: 2rem;
        }
    
        .input-container label {
            display: block;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
    
        .input-container input,
        .input-container textarea {
            width: 100%;
            padding: 0.5rem;
            margin-bottom: 1rem;
            box-sizing: border-box;
            border-radius: 4px;
            border: 1px solid #ccc;
        }
    
        .input-container textarea {
            height: 10rem;
            resize: vertical;
        }
    
        .input-container button {
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
        }
    
        .preview-container {
            flex-basis: 50%;
            padding: 1rem;
            box-sizing: border-box;
            text-align: center;
        }
    
        .preview-container h1 {
            margin-bottom: 2rem;
        }
    
        .preview-container h2 {
            margin-bottom: 1rem;
        }
    
        .preview-container section {
            margin-bottom: 2rem;
            padding: 1rem;
            background-color: #f2f2f2;
            border-radius: 4px;
        }
    
        .preview-container section h2 {
            margin-bottom: 0.5rem;
        }
    
        .preview-container section p {
            margin-bottom: 1rem;
        }
    
        .preview-container button {
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 2rem;
        }
 
    </style>
</head>
<body>

  
  <!-- <div class="main-content"> -->
        <div class="container">

          <div class="input-container">
            <!-- <h1 style="text-align:center">Document Creator</h1> -->
            <label for="title">Title:</label>
            <input type="text" id="title" placeholder="Enter document title">
            <!-- <label for="type">Type:</label>
            <input type="text" id="type" placeholder="Enter document type"> -->
            <label for="context">Context:</label>
            <textarea id="context" placeholder="Enter document context"></textarea>
            <label for="section">Section:</label>
            <textarea id="section" placeholder="Enter section details"></textarea>
            <button id="addSection">Add Section</button>
          </div>
          <div class="preview-container">
            <!-- <h1 style="text-align:center">Preview</h1> -->
            <h2 id="previewTitle"></h2>
            <h2 id="previewType"></h2>
            <p id="previewContext"></p>
            <div id="previewSections"></div>
            <button id="submit">Generate Content</button>
          </div>
      </div>
    <!-- </div> -->

    <div id="loading"></div>
  
    <!-- <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/docx@7.8.2/build/index.min.js"></script>
    <script src="https://unpkg.com/docx@5.0.2/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <!-- Include the spin.js library -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/spin.js/2.3.2/spin.min.js"></script> -->

    <!-- Include the spin.js CSS -->

    <script>
        const titleInput = document.getElementById("title");
        const typeInput = document.getElementById("type");
        const contextInput = document.getElementById("context");
        const sectionInput = document.getElementById("section");
        const addSectionButton = document.getElementById("addSection");
        const previewTitle = document.getElementById("previewTitle");
        const previewType = document.getElementById("previewType");
        const previewContext = document.getElementById("previewContext");
        const previewSections = document.getElementById("previewSections");
        const submitButton = document.getElementById("submit");
      
        let title = "";
        let type = "";
        let context = "";
        let sections = [];

        titleInput.addEventListener("input", (event) => {
          title = event.target.value;
          previewTitle.innerText =`Title: ${title}`;
        });
      
        // typeInput.addEventListener("input", (event) => {
        //   type = event.target.value;
        //   previewType.innerText = `Document Type: ${type}`;
        // })

        contextInput.addEventListener("input", (event) => {
          context = event.target.value;
          previewContext.innerText = `Context: ${context}`;
        })
      
        addSectionButton.addEventListener("click", () => {
          const section = sectionInput.value;
          if (section.trim() !== "") {
            sections.push(section);
            renderSections();
            sectionInput.value = "";
          }
        });

        function renderSections() {
          previewSections.innerHTML = "";
          sections.forEach((section, index) => {
            const sectionDiv = document.createElement("div");
            const sectionHeader = document.createElement("h2");
            const sectionText = document.createElement("p");
            const editButton = document.createElement("button");
            const deleteButton = document.createElement("button");
      
            sectionHeader.innerText = `Section ${index + 1}`;
            sectionText.innerText = section;
            editButton.innerText = "Edit";
            editButton.addEventListener("click", () => {
              const newSection = prompt("Enter new section text:", section);
              if (newSection !== null && newSection.trim() !== "") {
                sections[index] = newSection;
                renderSections();
              }
            });
            deleteButton.innerText = "Delete";
            deleteButton.addEventListener("click", () => {
              const confirmDelete = confirm("Are you sure you want to delete this section?");
              if (confirmDelete) {
                sections.splice(index, 1);
                renderSections();
              }
            });
      
            sectionDiv.appendChild(sectionHeader);
            sectionDiv.appendChild(sectionText);
            sectionDiv.appendChild(editButton);
            sectionDiv.appendChild(deleteButton);
            previewSections.appendChild(sectionDiv);
          });
        }
      
        submitButton.addEventListener("click", () => {
          if (title.trim() === "") {
           
            alert("Please enter a document title.");
            return;
          }
          
          // if (type.trim() === "") {
          
          //   alert("Please enter a document type.");
          //   return;
          // }

          if (sections.length === 0) {
         
            alert("Please add at least one section to the document.");
            return;
          }
      
          const confirmation = confirm("Are you sure you want to submit this document?");

          if (confirmation) {
            const documentData = {
              title: title,
              type: type,
              context: context,
              sections: sections,
            };


            $.ajax({
                url: 'https://37soa.edu.gh/createdocument.php',
                method: 'POST',
                data: JSON.stringify(documentData),
                success: function(response) {
                  let doc = new docx.Document();

                  let responseText = JSON.parse(response);

                  // create the first section
                  let section = {
                    children: []
                  };

                  // loop through the responseText array and add each paragraph to the section
                  for (let i = 0; i < responseText.length; i++) {

                    section.children.push(
                      new docx.Paragraph({
                        children: [
                          new docx.TextRun({
                            text: sections[i],
                            bold: true,
                            size: 32,
                            font: 'Arial',
                          }),
                        ],
                        spacing: {
                          line: 360,
                          before: 400,
                          after: 0, // reduce the spacing after the heading to 0
                        },
                      }),
                      new docx.Paragraph({
                        children: [
                          new docx.TextRun({
                            text: responseText[i][1],
                            size: 28,
                            font: 'Times New Roman',
                          }),
                        ],
                        spacing: {
                          line: 360,
                          before: 0, // reduce the spacing before the response text to 0
                          after: 400,
                        },
                      })
                    );

                  }

                  // add the section to the document
                  doc.addSection(section);

                  docx.Packer.toBlob(doc).then(function(blob) {
                    // Hide the loading animation
                    // spinner.stop();

                    saveAs(blob, title + ".docx");
                  });
                },
                error: function(xhr, status, error) {
                  console.error(error);

                }
              });

             }
        });

      </script>
</body>
</html>

