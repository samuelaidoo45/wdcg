<!-- <!DOCTYPE html>
<html>
  <head>
    <title>Steps Example</title>
    <style>
      body {
        background-color: #F7F7F7;
        font-family: Arial, sans-serif;
      }

      label {
        display: block;
        font-weight: bold;
        margin-bottom: 10px;
      }

      input[type="text"] {
        border: none;
        border-radius: 5px;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
        font-size: 18px;
        padding: 10px;
        width: 300px;
      }

      input[type="text"]:focus {
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
        outline: none;
      }

      ul {
        list-style: none;
        margin: 0;
        padding: 0;
      }

      li {
        background-color: #FFFFFF;
        border-radius: 5px;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
        margin-bottom: 10px;
        padding: 10px;
      }
    </style>
  </head>
  <body>
    <div style="margin: 20px;">
      <label for="step-input">Enter a Step:</label>
      <input type="text" id="step-input">

      <ul id="step-list"></ul>
    </div>

    <script>
      // Initialize an empty array to store the steps
      let stepsArray = [];

      // Get the input element from the HTML page
      let input = document.querySelector("#step-input");

      // Get the step list element from the HTML page
      let stepList = document.querySelector("#step-list");

      // Add an event listener to the input element
      input.addEventListener("keyup", function(event) {
        // Check if the user pressed the enter key
        if (event.key === "Enter") {
          // Add the new step to the array
          stepsArray.push(event.target.value);
          // Clear the input field
          event.target.value = "";
          // Add the new step to the list
          let newStep = document.createElement("li");
          newStep.textContent = stepsArray[stepsArray.length - 1];
          stepList.appendChild(newStep);
        }
      });
    </script>
  </body>
</html> -->
<!-- 
<!DOCTYPE html>
<html>
  <head>
    <title>Create Document</title>
    <style>
      body {
        background-color: #F7F7F7;
        font-family: Arial, sans-serif;
      }

      .page-title {
        font-size: 32px;
        font-weight: bold;
        margin-bottom: 20px;
        text-align: center;
      }

      label {
        display: block;
        font-weight: bold;
        margin-bottom: 10px;
      }

      input[type="text"] {
        border: none;
        border-radius: 5px;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
        font-size: 18px;
        padding: 10px;
        width: 300px;
      }

      input[type="text"]:focus {
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
        outline: none;
      }

      .enter-section {
        display: flex;
        justify-content: center;
        align-items: center;
        height: calc(100vh - 200px);
      }

      ul {
        list-style: none;
        margin: 0;
        padding: 0;
      }

      li {
        background-color: #FFFFFF;
        border-radius: 5px;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
        margin-bottom: 10px;
        padding: 10px;
      }
    </style>
  </head>
  <body>
    <div style="margin: 20px;">
      <div class="page-title">Create Document</div>
      <div class="enter-section">
        <label for="enter-input">Enter:</label>
        <input type="text" id="enter-input">
      </div>

      <ul id="enter-list"></ul>
    </div>

    <script>
      // Initialize an empty array to store the inputs
      let enterArray = [];

      // Get the input element from the HTML page
      let input = document.querySelector("#enter-input");

      // Get the enter list element from the HTML page
      let enterList = document.querySelector("#enter-list");

      // Add an event listener to the input element
      input.addEventListener("keyup", function(event) {
        // Check if the user pressed the enter key
        if (event.key === "Enter") {
          // Add the new input to the array
          enterArray.push(event.target.value);
          // Clear the input field
          event.target.value = "";
          // Add the new input to the list
          let newInput = document.createElement("li");
          newInput.textContent = enterArray[enterArray.length - 1];
          enterList.appendChild(newInput);
        }
      });
    </script>
  </body>
</html> -->

<!-- 
<!DOCTYPE html>
<html>
<head>
	<title>Create Document</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			margin: 0;
			padding: 0;
			display: flex;
			flex-direction: column;
			min-height: 100vh;
		}

		header {
			background-color: #333;
			color: #fff;
			padding: 1rem;
			text-align: center;
		}

		main {
			flex-grow: 1;
			display: flex;
			flex-direction: row;
		}

		form {
			flex-grow: 1;
			padding: 1rem;
		}

		label {
			display: block;
			margin-bottom: 0.5rem;
		}

		input {
			display: block;
			margin-bottom: 1rem;
			padding: 0.5rem;
			border: 1px solid #ccc;
			border-radius: 4px;
			width: 100%;
		}

		textarea {
			display: block;
			margin-bottom: 1rem;
			padding: 0.5rem;
			border: 1px solid #ccc;
			border-radius: 4px;
			width: 100%;
			height: 300px;
		}

		section {
			flex-grow: 1;
			padding: 1rem;
			border-left: 1px solid #ccc;
		}

		section h2 {
			margin-top: 0;
		}

		button {
			background-color: #333;
			color: #fff;
			padding: 0.5rem 1rem;
			border: none;
			border-radius: 4px;
			cursor: pointer;
		}

		button:hover {
			background-color: #666;
		}
	</style>
</head>
<body>
	<header>
		<h1>Create Document</h1>
	</header>
	<main>
		<form>
			<label for="title">Title and Type:</label>
			<input type="text" id="title" name="title" required>

			<label for="sections">Enter sections:</label>
			<textarea id="sections" name="sections" required></textarea>

			<button type="submit">Submit</button>
		</form>
		<section id="preview">
			<h2>Preview</h2>
			<h3 id="title-preview"></h3>
			<div id="sections-preview"></div>
		</section>
	</main>
	<script>
		const titleInput = document.getElementById('title');
		const sectionsInput = document.getElementById('sections');
		const titlePreview = document.getElementById('title-preview');
		const sectionsPreview = document.getElementById('sections-preview');

		titleInput.addEventListener('input', () => {
			titlePreview.textContent = titleInput.value;
		});

		sectionsInput.addEventListener('input', () => {
			sectionsPreview.innerHTML = sectionsInput.value;
		});

		document.querySelector('form').addEventListener('submit', event => {
			event.preventDefault();
			alert('Document submitted!');
		});
	</script>
</body>
</html>
 -->

<!-- 
 <!DOCTYPE html>
<html>
<head>
	<title>Document Creator</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			margin: 0;
			padding: 0;
		}
		.container {
			display: flex;
			flex-wrap: wrap;
		}
		.input-container {
			width: 50%;
			height: 100vh;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
		}
		.preview-container {
			width: 50%;
			height: 100vh;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
		}
		h1, h2, label, input, textarea, button {
			margin: 10px;
			font-size: 1.2rem;
		}
		input[type="text"], textarea {
			width: 80%;
			padding: 10px;
			border: 1px solid #ccc;
			border-radius: 5px;
		}
		button {
			padding: 10px;
			background-color: #4CAF50;
			color: white;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			transition: background-color 0.3s ease;
		}
		button:hover {
			background-color: #3e8e41;
		}
	</style>
</head>
<body>
	<div class="container">
		<div class="input-container">
			<h1>Document Creator</h1>
			<label for="title">Title:</label>
			<input type="text" id="title" placeholder="Enter document title">
			<label for="type">Type:</label>
			<input type="text" id="type" placeholder="Enter document type">
			<label for="section">Section:</label>
			<textarea id="section" placeholder="Enter section details"></textarea>
			<button id="addSection">Add Section</button>
		</div>
		<div class="preview-container">
			<h1>Preview</h1>
			<h2 id="previewTitle"></h2>
			<h2 id="previewType"></h2>
			<div id="previewSections"></div>
			<button id="submit">Submit</button>
		</div>
	</div>

	<script>
		const titleInput = document.getElementById("title");
		const typeInput = document.getElementById("type");
		const sectionInput = document.getElementById("section");
		const addSectionButton = document.getElementById("addSection");
		const previewTitle = document.getElementById("previewTitle");
		const previewType = document.getElementById("previewType");
		const previewSections = document.getElementById("previewSections");
		const submitButton = document.getElementById("submit");

		let sections = [];

		addSectionButton.addEventListener("click", () => {
			const section = sectionInput.value.trim();
			if (section !== "") {
				sections.push(section);
				renderSections();
				sectionInput.value = "";
			}
		});

		function renderSections() {
            previewSections.innerHTML = "";
            sections.forEach((section, index) => {
                const sectionDiv = document.createElement("div");
                const sectionHeader = document.createElement("h2");
                const sectionText = document.createElement("p");
                const editButton = document.createElement("button");
                const deleteButton = document.createElement("button");

                sectionHeader.innerText = section.title;
                sectionText.innerText = section.text;
                editButton.innerText = "Edit";
                deleteButton.innerText = "Delete";

                editButton.addEventListener("click", () => {
                editSection(index);
                });

                deleteButton.addEventListener("click", () => {
                deleteSection(index);
                });

                sectionDiv.appendChild(sectionHeader);
                sectionDiv.appendChild(sectionText);
                sectionDiv.appendChild(editButton);
                sectionDiv.appendChild(deleteButton);

                previewSections.appendChild(sectionDiv);
            });
        }

        function editSection(index) {
  const section = sections[index];
  const title = prompt("Enter section title:", section.title);
  const text = prompt("Enter section text:", section.text);
  if (title && text) {
    sections[index] = { title, text };
    renderSections();
  }
}

function deleteSection(index) {
  sections.splice(index, 1);
  renderSections();
}

document.addEventListener("DOMContentLoaded", () => {
  addSectionButton.addEventListener("click", () => {
    const title = sectionTitleInput.value;
    const text = sectionTextInput.value;
    if (title && text) {
      sections.push({ title, text });
      sectionTitleInput.value = "";
      sectionTextInput.value = "";
      renderSections();
    }
  });
});

</script>
</body>
</html>
 -->

<!-- 
 <!DOCTYPE html>
<html>
  <head>
    <title>Create Document</title>
    <style>
        /* Center content horizontally and vertically */
        html, body {
            height: 100%;
        }
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
    
        /* Set up the two-column layout */
        .container {
            display: flex;
            flex-direction: row;
            max-width: 800px;
            width: 100%;
        }
        .form-container {
            flex-basis: 50%;
            padding: 20px;
            background-color: #eee;
        }
        .preview-container {
            flex-basis: 50%;
            padding: 20px;
            background-color: #ddd;
        }
    
        /* Style the form inputs and buttons */
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
        }
        input[type="text"],
        select {
            display: block;
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        textarea {
            display: block;
            width: 100%;
            height: 100px;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        button[type="submit"] {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #333;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button[type="submit"]:hover {
            background-color: #555;
        }
    
        /* Style the preview sections */
        h2 {
            font-size: 24px;
            margin-bottom: 10px;
        }
        p {
            margin-bottom: 20px;
        }
        button {
            margin-right: 10px;
            background-color: #333;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #555;
            color: #fff;
        }
        .edit-button {
            background-color: #ffcc00;
            color: #333;
        }
        .edit-button:hover {
            background-color: #ffc107;
            color: #333;
        }
        .delete-button {
            background-color: #dc3545;
            color: #fff;
        }
        .delete-button:hover {
            background-color: #c82333;
            color: #fff;
        }
    </style>
    
  </head>
  <body>
    <div>
      <h1>Create a New Document</h1>
      <form>
        <label for="title">Title:</label>
        <input type="text" id="title" name="title">

        <label for="documentType">Document Type:</label>
        <select id="documentType" name="documentType">
          <option value="article">Article</option>
          <option value="report">Report</option>
          <option value="proposal">Proposal</option>
          <option value="other">Other</option>
        </select>

        <div>
          <label for="sectionTitle">Section Title:</label>
          <input type="text" id="sectionTitle" name="sectionTitle">

          <label for="sectionContent">Section Content:</label>
          <textarea id="sectionContent" name="sectionContent"></textarea>

          <button type="button" id="addSectionButton">Add Section</button>
        </div>
      </form>
    </div>

    <div>
      <h2>Preview</h2>
      <div id="previewSections"></div>
      <button type="button" id="submitButton">Submit</button>
    </div>
  </body>
</html>
 -->

 <!-- <!DOCTYPE html>
<html>
<head>
	<title>Document Creator</title>
   
    
</head>
<body>
	<div class="container">
		<div class="input-container">
			<h1>Word Document Content Creator</h1>
			<label for="title">Title:</label>
			<input type="text" id="title" placeholder="Enter document title">
			<label for="type">Type:</label>
			<input type="text" id="type" placeholder="Enter document type">
			<label for="section">Section:</label>
			<textarea id="section" placeholder="Enter section details"></textarea>
			<button id="addSection">Add Section</button>
		</div>
		<div class="preview-container">
			<h1>Preview</h1>
			<h2 id="previewTitle"></h2>
			<h2 id="previewType"></h2>
			<div id="previewSections"></div>
			<button id="submit">Generate</button>
		</div>
	</div>
   
      
</body>
</html> -->


<!DOCTYPE html>
<html>
<head>
	<title>Content Generator for Word Document</title>
    <link rel="stylesheet" href="spin.css">
    <style>
 
        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: flex-start;
        }

        /* .sidebar{
            flex-basis: 20%;
            padding: 1rem;
            box-sizing: border-box;            
        }
     */
        .input-container {
            flex-basis: 50%;
            padding: 1rem;
            box-sizing: border-box;
        }
    
        .input-container h1 {
            margin-bottom: 2rem;
        }
    
        .input-container label {
            display: block;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
    
        .input-container input,
        .input-container textarea {
            width: 100%;
            padding: 0.5rem;
            margin-bottom: 1rem;
            box-sizing: border-box;
            border-radius: 4px;
            border: 1px solid #ccc;
        }
    
        .input-container textarea {
            height: 10rem;
            resize: vertical;
        }
    
        .input-container button {
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
        }
    
        .preview-container {
            flex-basis: 50%;
            padding: 1rem;
            box-sizing: border-box;
            text-align: center;
        }
    
        .preview-container h1 {
            margin-bottom: 2rem;
        }
    
        .preview-container h2 {
            margin-bottom: 1rem;
        }
    
        .preview-container section {
            margin-bottom: 2rem;
            padding: 1rem;
            background-color: #f2f2f2;
            border-radius: 4px;
        }
    
        .preview-container section h2 {
            margin-bottom: 0.5rem;
        }
    
        .preview-container section p {
            margin-bottom: 1rem;
        }
    
        .preview-container button {
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 2rem;
        }

        @media only screen and (max-width: 767px) {
          .container {
            flex-direction: column;
          }
          
          .input-container,
          .preview-container {
            flex-basis: 100%;
          }
      }


      #popup-container {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.5);
  z-index: 1;
}

#popup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: white;
  padding: 20px;
  border-radius: 5px;
}

#close-popup {
  display: block;
  margin-top: 10px;
  background-color: #337ab7;
  color: white;
  padding: 5px 10px;
  border-radius: 3px;
  border: none;
  cursor: pointer;
}


 
    </style>
    <script src="spin.js">
    </script>
</head>
<body>

  <!-- <div class="main-content"> -->
        <div class="container">
          <div class="input-container">
            <h1 style="text-align:center">Document Creator</h1>
            <label for="title">Title:</label>
            <input type="text" id="title" placeholder="What is the document about? (e.g. Marketing Plan for New Product Launch)">
            <!-- <label for="type">Type:</label>
            <input type="text" id="type" placeholder="Enter document type"> -->
            <label for="context">Context:</label>
            <textarea id="context" placeholder="What is the main issue the document is addressing? (e.g. Lack of Access to Healthcare)"></textarea>
            <label for="section">Section:</label>
            <textarea id="section" placeholder="What are the main sections of your document? (e.g. Executive Summary, Methodology, Results)"></textarea>
            <button id="addSection">Add Section</button>
            <button id="open-popup">Click me to open the pop-up!</button>
          </div>
          <a href="https://forms.gle/EycQ1LMqK9d1bA4LA">Please fill this form to give us feedback</a>

          <div class="preview-container">
            <h1 style="text-align:center">Preview</h1>
            <h2 id="previewTitle"></h2>
            <h2 id="previewType"></h2>
            <p id="previewContext"></p>
            <div id="previewSections"></div>
            <button id="submit">Generate Content</button>

          </div>
      </div>
    <!-- </div> -->


<div id="popup-container">
  <div id="popup">
    <h2>Welcome to our app!</h2>
    <p>Welcome to our app! We're thrilled to have you here and we can't wait to show you what we've created. Our app is a powerful content generator designed to help you create high-quality Word documents quickly and easily. Whether you're a student, a professional, or someone who just needs to write a letter, our app can help you create great content in no time. We're committed to making our app the best it can be, so if you have any feedback or questions, please let us know on <a>samuelaidoo45@gmail.com</a> and <a href="https://forms.gle/EycQ1LMqK9d1bA4LA">Please provide feedback</a>. Thanks for choosing our app and happy creating!</p>
    <button id="close-popup">Close</button>
  </div>
</div>


    <div id="loadingSpinner"></div>
  
    <!-- <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/docx@7.8.2/build/index.min.js"></script>
    <script src="https://unpkg.com/docx@5.0.2/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <!-- Include the spin.js library -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/spin.js/2.3.2/spin.min.js"></script> -->

    <!-- Include the spin.js CSS -->

    <script>
        const titleInput = document.getElementById("title");
        const typeInput = document.getElementById("type");
        const contextInput = document.getElementById("context");
        const sectionInput = document.getElementById("section");
        const addSectionButton = document.getElementById("addSection");
        const previewTitle = document.getElementById("previewTitle");
        const previewType = document.getElementById("previewType");
        const previewContext = document.getElementById("previewContext");
        const previewSections = document.getElementById("previewSections");
        const submitButton = document.getElementById("submit");
      
        let title = "";
        let type = "";
        let context = "";
        let sections = [];


        const openPopupButton = document.getElementById("open-popup");
        const closePopupButton = document.getElementById("close-popup");
        const popupContainer = document.getElementById("popup-container");

        popupContainer.style.display = "block";


        openPopupButton.addEventListener("click",()=>{
          popupContainer.style.display = "block";
        })


        closePopupButton.addEventListener("click", () => {
          popupContainer.style.display = "none";
        });


        titleInput.addEventListener("input", (event) => {
          title = event.target.value;
          previewTitle.innerText =`Title: ${title}`;
        });
      
        // typeInput.addEventListener("input", (event) => {
        //   type = event.target.value;
        //   previewType.innerText = `Document Type: ${type}`;
        // })

        contextInput.addEventListener("input", (event) => {
          context = event.target.value;
          previewContext.innerText = `Context: ${context}`;
        })
      
        addSectionButton.addEventListener("click", () => {
          const section = sectionInput.value;
          if (section.trim() !== "") {
            sections.push(section);
            renderSections();
            sectionInput.value = "";
          }
        });

        function renderSections() {
          previewSections.innerHTML = "";
          sections.forEach((section, index) => {
            const sectionDiv = document.createElement("div");
            const sectionHeader = document.createElement("h2");
            const sectionText = document.createElement("p");
            const editButton = document.createElement("button");
            const deleteButton = document.createElement("button");
      
            sectionHeader.innerText = `Section ${index + 1}`;
            sectionText.innerText = section;
            editButton.innerText = "Edit";
            editButton.addEventListener("click", () => {
              const newSection = prompt("Enter new section text:", section);
              if (newSection !== null && newSection.trim() !== "") {
                sections[index] = newSection;
                renderSections();
              }
            });
            deleteButton.innerText = "Delete";
            deleteButton.addEventListener("click", () => {
              const confirmDelete = confirm("Are you sure you want to delete this section?");
              if (confirmDelete) {
                sections.splice(index, 1);
                renderSections();
              }
            });
      
            sectionDiv.appendChild(sectionHeader);
            sectionDiv.appendChild(sectionText);
            sectionDiv.appendChild(editButton);
            sectionDiv.appendChild(deleteButton);
            previewSections.appendChild(sectionDiv);
          });
        }
      
        submitButton.addEventListener("click", () => {
          if (title.trim() === "") {
           
            alert("Please enter a document title.");
            return;
          }
          
          // if (type.trim() === "") {
          
          //   alert("Please enter a document type.");
          //   return;
          // }

          if (sections.length === 0) {
         
            alert("Please add at least one section to the document.");
            return;
          }
      
          const confirmation = confirm("Are you sure you want to submit this document?");

          if (confirmation) {
            const documentData = {
              title: title,
              type: type,
              context: context,
              sections: sections,
            };

            const opts = {
            lines: 13, // The number of lines to draw
            length: 20, // The length of each line
            width: 10, // The line thickness
            radius: 30, // The radius of the inner circle
            scale: 1, // Scales overall size of the spinner
            corners: 1, // Corner roundness (0..1)
            color: "#000", // CSS color or array of colors
            fadeColor: "transparent", // CSS color or array of colors
            speed: 1, // Rounds per second
            rotate: 0, // The rotation offset
            animation: "spinner-line-fade-default", // The CSS animation name for the lines
            direction: 1, // 1: clockwise, -1: counterclockwise
            zIndex: 2e9, // The z-index (defaults to 2000000000)
            className: "spinner", // The CSS class to assign to the spinner
            top: "50%", // Top position relative to parent
            left: "50%", // Left position relative to parent
            shadow: "0 0 1px transparent", // Box-shadow for the lines
            position: "absolute" // Element positioning
          };
          const target = document.getElementById("loadingSpinner");
          // let spinner = new Spinner(opts).spin(target);
          var spinner = new Spin.Spinner(opts).spin(target);

            $.ajax({
                url: 'https://37soa.edu.gh/createdocument.php',
                method: 'POST',
                data: JSON.stringify(documentData),
                success: function(response) {
                  let doc = new docx.Document();

                  let responseText = JSON.parse(response);

                  // create the first section
                  let section = {
                    children: []
                  };

                  // loop through the responseText array and add each paragraph to the section
                  for (let i = 0; i < responseText.length; i++) {

                    section.children.push(
                      new docx.Paragraph({
                        children: [
                          new docx.TextRun({
                            text: sections[i],
                            bold: true,
                            size: 32,
                            font: 'Arial',
                          }),
                        ],
                        spacing: {
                          line: 360,
                          before: 400,
                          after: 0, // reduce the spacing after the heading to 0
                        },
                      }),
                      new docx.Paragraph({
                        children: [
                          new docx.TextRun({
                            text: responseText[i][1],
                            size: 28,
                            font: 'Times New Roman',
                          }),
                        ],
                        spacing: {
                          line: 360,
                          before: 0, // reduce the spacing before the response text to 0
                          after: 400,
                        },
                      })
                    );

                  }

                  // add the section to the document
                  doc.addSection(section);

                  docx.Packer.toBlob(doc).then(function(blob) {
                    // Hide the loading animation
                    // spinner.stop();

                    saveAs(blob, title + ".docx");
                  });
                },
                error: function(xhr, status, error) {
                  console.error(error);

                },
                complete: function() {
                  // Hide the loading spinner
                  spinner.stop();
                }
              });

             }
        });

      </script>
      <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-analytics.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyB0Md4LB3W4OZSJC7ywX0z2xcbJ5NbbOKg",
          authDomain: "wdcg-502f8.firebaseapp.com",
          projectId: "wdcg-502f8",
          storageBucket: "wdcg-502f8.appspot.com",
          messagingSenderId: "848359225773",
          appId: "1:848359225773:web:bf11746a853d070e3e0924",
          measurementId: "G-PJFCD117YE"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
      </script>
</body>
</html>

